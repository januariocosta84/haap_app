{% extends "core/base.html" %}
 <title>HAAP | {% block title %}Logs{% endblock %}</title>
{% block content %}
<div class="container-fluid mt-4">
  <h2 class="mb-3">üìä App Usage Logs</h2>

  <!-- Filter -->
  <form method="get" class="mb-3">
    <select name="activity" class="form-select" onchange="this.form.submit()">
      <option value="">All Activities</option>
      {% for key, value in logs.model.ACTIVITY_TYPE_CHOICES %}
        <option value="{{ key }}" {% if request.GET.activity == key %}selected{% endif %}>
          {{ value }}
        </option>
      {% endfor %}
    </select>
  </form>

  <!-- Logs Table -->
  <table class="table table-striped table-bordered">
    <thead class="table-dark">
      <tr>
        <th>Child</th>
        <th>Theme</th>
        <th>Activity</th>
        <th>Group</th>
        <th>Assessed</th>
        <th>Result</th>
        <th>Date</th>
        <th>Duration (s)</th>
      </tr>
    </thead>
    <tbody>
      {% for log in logs %}
      <tr>
        <td>{{ log.child.first_name }} {{ log.child.last_name }}</td>
        <td>{{ log.theme }}</td>
        <td>{{ log.get_activity_type_display }}</td>
        <td>{{ log.group }}</td>
        <td>{% if log.is_assessed %}‚úÖ{% else %}‚ùå{% endif %}</td>
        <td>{% if log.was_successful %}<span class="text-success">Success</span>{% else %}<span class="text-danger">Fail</span>{% endif %}</td>
        <td>{{ log.date_accessed }}</td>
        <td>{{ log.duration_seconds }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="8" class="text-center">No logs found.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Pagination -->
  <nav>
    <ul class="pagination">
      {% if logs.has_previous %}
        <li class="page-item"><a class="page-link" href="?page={{ logs.previous_page_number }}">Previous</a></li>
      {% endif %}

      <li class="page-item disabled"><a class="page-link">Page {{ logs.number }} of {{ logs.paginator.num_pages }}</a></li>

      {% if logs.has_next %}
        <li class="page-item"><a class="page-link" href="?page={{ logs.next_page_number }}">Next</a></li>
      {% endif %}
    </ul>
  </nav>
</div>
{% endblock %}
